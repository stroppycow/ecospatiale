install.packages("rpart.plot")
library(rpart.plot)
install.packages("rattle")
library(rattle)
library(rattle)
Data$Finess <- as.factor(trunc(Data$FINESS/10)-trunc(Data$FINESS/1000)*100
+trunc(Data$FINESS/1000000)*100)
Data$dep <- as.factor(Data$dep)
table(Data$Finess,Data$Sortie1an)
learn <- Data[1:200,]
test <- Data[201:319,]
params <- rpart.control(xval=nrow(learn)-1,
minsplit=30,
minbucket=10,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(Sortie1an ~Finess+dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
Data <- read.csv('O:/Annee2/stats/Groupe05/CSV.csv',header=TRUE,sep=",")
Data$Finess <- as.factor(trunc(Data$FINESS/10)-trunc(Data$FINESS/1000)*100
+trunc(Data$FINESS/1000000)*100)
Data$dep <- as.factor(Data$dep)
table(Data$Finess,Data$Sortie1an)
learn <- Data[1:200,]
test <- Data[201:319,]
params <- rpart.control(xval=nrow(learn)-1,
minsplit=30,
minbucket=10,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(Sortie1an ~Finess+dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
fancyRpartPlot(tree.model)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
fancyRpartPlot(tree.model)
tree.model <- rpart(Sortie1an ~Finess+dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
params <- rpart.control(xval=nrow(learn)-1,
minsplit=15,
minbucket=10,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(Sortie1an ~Finess+dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
params <- rpart.control(xval=nrow(learn)-1,
minsplit=15,
minbucket=5,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
fancyRpartPlot(tree.model)
params <- rpart.control(xval=nrow(learn)-1,
minsplit=10,
minbucket=10,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
params <- rpart.control(xval=nrow(learn)-1,
minsplit=15,
minbucket=5,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
pred <- predict(tree.model,newdata=test,type="class")
table(test$Sortie1an,pred)
tree.model <- rpart(Finess ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
pred <- predict(tree.model,newdata=test,type="class")
table(test$Sortie1an,pred)
pred <- predict(tree.model,newdata=test,type="class")
table(test$Finess,pred)
ech <- sample.int(319,200)
learn <- Data[ech,]
test <- Data[-ech,]
params <- rpart.control(xval=nrow(learn)-1,
minsplit=15,
minbucket=5,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
params <- rpart.control(xval=nrow(learn)-1,
minsplit=15,
minbucket=10,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
fancyRpartPlot(tree.model)
pred <- predict(tree.model,newdata=test,type="class")
table(test$Finess,pred)
table(test$Sortie1an,pred)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini",loss=t)
)
rpart.plot(tree.model)
fancyRpartPlot(tree.model)
t <- matrix(c(0,1000,1,0),nrow=2)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini",loss=t)
)
rpart.plot(tree.model)
fancyRpartPlot(tree.model)
pred <- predict(tree.model,newdata=test,type="class")
table(test$Sortie1an,pred)
params <- rpart.control(xval=nrow(learn)-1,
minsplit=30,
minbucket=15,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini",loss=t)
)
rpart.plot(tree.model)
fancyRpartPlot(tree.model)
pred <- predict(tree.model,newdata=test,type="class")
table(test$Sortie1an,pred)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
prp(tree.model,snip=TRUE)
fancyRpartPlot(tree.model)
pred <- predict(tree.model,newdata=test,type="class")
table(test$Sortie1an,pred)
install.packages("partykit")
repos="http://R-Forge.R-project.org")
library("CHAID")
install.packages("partykit")
install.packages("CHAID",
repos="http://R-Forge.R-project.org")
library("CHAID")
tree.chaid <- chaid(Sortie1an ~ dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn)
plotcp(tree.model)
params <- rpart.control(xval=nrow(learn)-1,
minsplit=30,
minbucket=15,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(Sortie1an ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
fancyRpartPlot(tree.model)
Data <- read.csv('O:/Annee2/stats/Groupe05/CSV.csv',header=TRUE,sep=",")
Data <- read.csv('O:/Annee2/stats/Groupe05/CSV.csv',header=TRUE,sep=",")
Data <- read.csv('O:/Annee2/stats/Groupe05/CSV.csv',header=TRUE,sep=",")
params <- rpart.control(xval=nrow(learn)-1,
minsplit=30,
minbucket=15,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(anc ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
tree.model <- rpart(duree ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
Data <- read.csv('O:/Annee2/stats/Groupe05/CSV.csv',header=TRUE,sep=",")
Data$Finess <- as.factor(trunc(Data$FINESS/10)-trunc(Data$FINESS/1000)*100
+trunc(Data$FINESS/1000000)*100)
Data$dep <- as.factor(Data$dep)
ech <- sample.int(319,200)
learn <- Data[ech,]
test <- Data[-ech,]
params <- rpart.control(xval=nrow(learn)-1,
minsplit=30,
minbucket=15,
maxcompete=4,
maxsurrogate=4,
usesurrogate=2,
maxdepth=30)
tree.model <- rpart(duree ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
tree.model <- rpart(anc ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="class",
parms=list(split="gini")
)
rpart.plot(tree.model)
fancyRpartPlot(tree.model)
tree.model <- rpart(anc ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="exp",
parms=list(split="gini")
)
rpart.plot(tree.model)
fancyRpartPlot(tree.model)
tree.model <- rpart(anc ~dep+situ_fam+loc+enf+ancienlog+effectif_famille,
data=learn,
control=params,
method="poisson",
parms=list(split="gini")
)
rpart.plot(tree.model)
fancyRpartPlot(tree.model)
t<-read.csv("C:\Users\id0881\Downloads\indice-de-developpement-humain-idh2-des-communes-dile-de-france")
t<-read.csv("C:/Users/id0881/Downloads/indice-de-developpement-humain-idh2-des-communes-dile-de-france")
t<-read.csv("P:\Cours\Carto\IDH.csv")
t<-read.csv("P:/Cours/Carto/IDH.csv")
t<-read.csv("P:/Cours/Carto/IDH.csv",header=TRUE)
t
t<-read.csv("P:/Cours/Carto/IDH.csv",header=TRUE)
t[1,]
t$annee
?read.csv
t<-read.csv("P:/Cours/Carto/IDH.csv",header=TRUE,sep=";")
View(t)
t[t$annee='2013']
t[t$annee=='2013']
t[t$annee=2013]
t[,t$annee=2013]
t$annee
t$annee=2013
t$annee==2013
t[t$annee==2013,]
t<-read.csv("P:/Cours/Carto/IDH.csv",header=TRUE,sep=";")
t[t$annee==2013,]
u<-t[t$annee==2013,]
write.csv(u,"P:/Cours/Carto/IDH.csv2")
write.csv(u,"P:/Cours/Carto/IDH2.csv")
u$annee
u$idh2
u$idh2==.
v<-u[u$idh2==0,]
v
v<-t[t$idh2==0,]
View(v)
v<-u[u$idh2!=0,]
v<-u[u$idh2==0,]
v<-u[u$idh2!=0,]
v<-u[u$idh2!='NA',]
v<-u[u$idh2=='NA',]
read.csv('P:/Cours/Carto/IDH2.csv')
t<-read.csv('P:/Cours/Carto/IDH2.csv')
t$idh2
t$idh2==missing
c(t$idh2<0)
c(t$idh2<'   NA')
t[t$idh2<'   NA']
t[t$idh2<'   NA',]
t[t$idh2<0,]
View(t)
View(t)
t[t$idh2='',]
t[-t$idh2<1,]
t[-(t$idh2<1),]
t[-t[t$idh2<1,],]
t[t$idh2<1,]
is.null(t$idh2)
t[!is.NA(t$idh2),]
t[!is.na(t$idh2),]
t[is.na(t$idh2),]
u<-t[is.na(t$idh2),]
u<-t[!is.na(t$idh2),]
write.csv(u,file='P:/Cours/Carto/IDH3.csv')
v<-substr(u$insee,stop=2)
v<-substr(u$insee,start=1,stop=2)
v
w<-u$idh2*u$pop
w[1]
u$idh2[1]
w[1]/u$idh2[1]
u$w<-u$idh2*u$pop
u$v<-as.factor(substr(u$insee,start=1,stop=2))
l<-sum(u$pop[u$v="75"])
l<-sum(u$pop[u$v=="75"])
levels(v)
levels(u$v)
l75<-sum(u$pop[u$v=="75"])
l77<-sum(u$pop[u$v=="77"])
l78<-sum(u$pop[u$v=="78"])
l91<-sum(u$pop[u$v=="91"])
l92<-sum(u$pop[u$v=="92"])
l93<-sum(u$pop[u$v=="93"])
l94<-sum(u$pop[u$v=="94"])
l95<-sum(u$pop[u$v=="95"])
rm(l)
rm(v)
rm(w)
l<-data.frame()
l[1,2]<-sum(u$pop[u$v=="75"])
l[,1]=c(1:8)
l<-data.frame()[8][2]
l$num=c(1:8)
l<-data.frame(c(1:8))
l<-data.frame(c(75,77,78,91,92,93,94,95))
l<-data.frame(c(75,77,78,91,92,93,94,95),row.names=c("num"))
l<-data.frame(c(75,77,78,91,92,93,94,95),row.names="num")
l<-data.frame(c(75,77,78,91,92,93,94,95))
l[1,2]<-sum(u$pop[u$v=="75"])
View(l)
View(l)
l<-data.frame("nom"=c(75,77,78,91,92,93,94,95))
View(l)
View(l)
l<-data.frame("num"=c(75,77,78,91,92,93,94,95))
l[1,2]<-sum(u$pop[u$v=="75"])
l[2,2]<-sum(u$pop[u$v=="77"])
l[3,2]<-sum(u$pop[u$v=="78"])
l[4,2]<-sum(u$pop[u$v=="91"])
l[5,2]<-sum(u$pop[u$v=="92"])
l[6,2]<-sum(u$pop[u$v=="93"])
l[7,2]<-sum(u$pop[u$v=="94"])
l[8,2]<-sum(u$pop[u$v=="95"])
sum(u$pop)
sum(l$V2)
l<-data.frame("num"=c(75,77,78,91,92,93,94,95))
l[1,2]<-sum(u$pop[u$v=="75"])
l[2,2]<-sum(u$pop[u$v=="77"])
l[3,2]<-sum(u$pop[u$v=="78"])
l[4,2]<-sum(u$pop[u$v=="91"])
l[5,2]<-sum(u$pop[u$v=="92"])
l[6,2]<-sum(u$pop[u$v=="93"])
l[7,2]<-sum(u$pop[u$v=="94"])
l[8,2]<-sum(u$pop[u$v=="95"])
l[1,3]<-sum(u$w[u$v=="75"])
l[2,3]<-sum(u$w[u$v=="77"])
l[3,3]<-sum(u$w[u$v=="78"])
l[4,3]<-sum(u$w[u$v=="91"])
l[5,3]<-sum(u$w[u$v=="92"])
l[6,3]<-sum(u$w[u$v=="93"])
l[7,3]<-sum(u$w[u$v=="94"])
l[8,3]<-sum(u$w[u$v=="95"])
l$idh=l$V3/l$V2
write.csv(l,file='P:/Cours/Carto/IDHDep.csv')
l$idh=round(l$V3/l$V2,2)
write.csv(l,file='P:/Cours/Carto/IDHDep.csv')
library(reader)
library(readr)
read.tsv("ilc_di03.tsv")
read.tsv("C:/Users/id0881/Downloads/ilc_di03.tsv/ilc_di03.tsv")
read_tsv("C:/Users/id0881/Downloads/ilc_di03.tsv/ilc_di03.tsv")
tsv <- read_tsv("C:/Users/id0881/Downloads/ilc_di03.tsv/ilc_di03.tsv")
View(tsv)
View(tsv)
80.2+6.3
86.5+5.3
macon <- c(10.5,16.3,28.5,45.6,60,67.7,72.5,80.2,86.5,91.8,94.6,97.5,99.4,100)
dep <- c(7.4,12.8,21.9,32.5,42.4,48.6,53.1,61.7,71.2,80.8,86.9,94.1,98.5,100)
ligne <- c(1:14)
plot(macon,ligne)
plot(ligne*dep)
plot(ligne*macon)
plot(ligne*macon)
plot(ligne*dep)
plot(macon)
plot(dep)
plot(macon)
points(dep)
plot(macon)
points(dep,col=red,cph=1)
points(dep,col='red',cph=1)
plot(macon,pch=3,col='blue')
points(dep,col='red',pch=3)
plot(macon,pch=3,col='blue',lty=1)
points(dep,col='red',pch=3,lty=1)
plot(macon,pch=3,col='blue',lty=2)
points(dep,col='red',pch=3,lty=1)
#Creation de divers dossiers
dir.create("../data")
dir.create("../shapefile")
dir.create("../sorties")
#Resultat election presidentielle
download.file("https://www.data.gouv.fr/s/resources/election-presidentielle-des-23-avril-et-7-mai-2017-resultats-definitifs-du-2nd-tour-par-communes/20170511-093054/Presidentielle_2017_Resultats_Communes_Tour_2_c.xls", "../data/pres2017.xls",mode="wb")
#Liste d'adjacence des communes
download.file("https://www.data.gouv.fr/fr/datasets/r/07aab4fb-f1a9-4ad6-9bb3-3c7b1a83307c", "../data/adj_comm.csv",mode="wb")
#Base comparateur de territoire
download.file("https://www.insee.fr/fr/statistiques/fichier/2521169/base_cc_comparateur.zip", "../data/base_cc_comparateur.zip")
unzip("../data/base_cc_comparateur.zip",exdir="../data/base_cc_comparateur",overwrite = T)
file.rename("../data/base_cc_comparateur/base_cc_comparateur.xls", "../data/base_cc_comparateur.xls")
unlink(x="../data/base_cc_comparateur", recursive = T)
unlink("../data/base_cc_comparateur.zip")
#Shapefile des communes 1 javnvier 2017
download.file("http://osm13.openstreetmap.fr/~cquest/openfla/export/communes-20170111-shp.zip", "../shapefile/communes2017.zip")
unzip("../shapefile/communes2017.zip",exdir="../shapefile/communes2017",overwrite = T)
unlink("../shapefile/communes2017.zip")
#Shapefile de l'europe
download.file("https://ec.europa.eu/eurostat/cache/GISCO/distribution/v2/nuts/download/ref-nuts-2016-03m.shp.zip","../shapefile/europe.zip")
unzip("../shapefile/europe.zip",exdir="../shapefile/europe",overwrite = T)
unlink("../shapefile/europe.zip")
setwd("P:/Cours/Spatiale/ecospatiale")
#Base comparaison démographique
download.file("https://www.insee.fr/fr/statistiques/fichier/3564100/base-cc-evol-struct-pop-2015.zip", "../data/base-cc-evol-struct-pop-2015.zip")
unzip("../data/base-cc-evol-struct-pop-2015.zip",exdir="../base-cc-evol-struct-pop-2015",overwrite = T)
file.rename("../data/base-cc-evol-struct-pop-2015/base-cc-evol-struct-pop-2015.xls", "../data/base-cc-evol-struct-pop-2015.xls")
unlink(x="../data/base-cc-evol-struct-pop-2015", recursive = T)
unlink("../data/base-cc-evol-struct-pop-2015.zip")
#Base comparaison démographique
download.file("https://www.insee.fr/fr/statistiques/fichier/3564100/base-cc-evol-struct-pop-2015.zip", "../data/base-cc-evol-struct-pop-2015.zip")
unzip("../data/base-cc-evol-struct-pop-2015.zip",exdir="../data/base-cc-evol-struct-pop-2015",overwrite = T)
file.rename("../data/base-cc-evol-struct-pop-2015/base-cc-evol-struct-pop-2015.xls", "../data/base-cc-evol-struct-pop-2015.xls")
unlink(x="../data/base-cc-evol-struct-pop-2015", recursive = T)
unlink("../data/base-cc-evol-struct-pop-2015.zip")
